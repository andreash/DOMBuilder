/**
 * DOMBuilder 2.0.0-pre (modes: dom, html, template) - https://github.com/insin/DOMBuilder
 * MIT licensed
 */
(function(b,s){function u(m,e){for(var a in e)m[a]=e[a];return m}function w(m){for(var e={},a=0,c=m.length;a<c;a++)e[m[a]]=!0;return e}function k(m){return x.call(m)==="[object Array]"}function l(m){return x.call(m)==="[object Function]"}function o(m,a){return!!m&&x.call(m)==="[object Object]"&&(a=="dom"?!m.nodeType:n.modes[a].isObject(m))}function y(a){for(var e=0,g=a.length,c;e<g;e++)c=a[e],k(c)&&(g+=c.length-1,C.apply(a,[e,1].concat(c)),e--)}function j(a){for(var e={},g=0,c;c=d[g];g++)e[c.toUpperCase()]=
p(c,a);return e}function p(a,e){var g=function(){if(arguments.length){var c=q.call(arguments),g,d=c.length,i=c[0];d===1&&k(i)?c=i:o(i,e||n.mode)?(g=i,c=d==2&&k(c[1])?c[1]:q.call(c,1)):c=q.call(c);return n.createElement(a,g,c,e)}else return g=e||n.mode,g=="dom"?r.createElement(a):n.modes[g].createElement(a,{},[])};g.map=function(){var c=q.call(arguments);if(k(c[0]))var g={},d=c[0],c=l(c[1])?c[1]:null;else g=c[0],d=c[1],c=l(c[2])?c[2]:null;return n.map(a,g,d,c,e)};return g}var v=typeof module!=="undefined"&&
module.exports,r=b.document,x=Object.prototype.toString,f=Object.prototype.hasOwnProperty,q=Array.prototype.slice,C=Array.prototype.splice,z,A,a,i,d="a abbr acronym address area b bdo big blockquote body br button caption cite code col colgroup dd del dfn div dl dt em fieldset form frame frameset h1 h2 h3 h4 h5 h6 hr head html i iframe img input ins kbd label legend li link map meta noscript object ol optgroup option p param pre q samp script select small span strong style sub sup table tbody td textarea tfoot th thead title tr tt ul var".split(" ");
if(typeof jQuery!="undefined")z=jQuery.attrFn,v||(A=function(a,e){if(f.call(e,"innerHTML")){var g=e.innerHTML;delete e.innerHTML;return jQuery("<"+a+">",e).html(g).get(0)}else return jQuery("<"+a+">",e).get(0)},a=function(a,e,g){jQuery("#"+a)[e](g)},i=function(a,e){jQuery(a).html(e)});else if(z=w("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" ")),!v){var t=
function(){var a=r.createElement("div");a.style.display="none";a.innerHTML='<span style="color:silver;">s<span>';return/silver/.test(a.getElementsByTagName("span")[0].getAttribute("style"))}(),D=/^(?:href|src|style)$/,F={cellspacing:"cellSpacing","class":"className",colspan:"colSpan","for":"htmlFor",frameborder:"frameBorder",maxlength:"maxLength",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",usemap:"useMap"};A=function(a,e){var g=r.createElement(a),c,d;f.call(e,"innerHTML")&&(i(g,e.innerHTML),
delete e.innerHTML);for(c in e)if(d=e[c],c=F[c]||c,z[c])g["on"+c]=d;else{var b=D.test(c);(c in g||g[c]!==s)&&!b?g[c]=d:!t&&c=="style"?g.style.cssText=""+d:g.setAttribute(c,""+d)}return g};a=function(a,e,g){r.getElementById(a)["on"+e]=g};i=function(a,e){try{a.innerHTML=e}catch(g){var c=r.createElement("div");for(c.innerHTML=e;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}}}var n={version:"2.0.0-pre",mode:v?"html":"dom",modes:{},addMode:function(a){this.modes[a.name]=
a;this[a.name]=u(j(a.name),a.api)},withMode:function(a,e){var g=this.mode;this.mode=a;try{return e.apply(null,q.call(arguments,2))}finally{this.mode=g}},elements:j(),apply:function(a){a=a||{};u(a,this.elements);return a},dom:j("dom"),createElement:function(a,e,g,c){e=e||{};g=g||[];y(g);c=c||this.mode;if(c!="dom")return this.modes[c].createElement(a,e,g);c=f.call(e,"innerHTML");a=A(a,e);if(!c)for(var e=0,c=g.length,d;e<c;e++)(d=g[e])&&d.nodeType?a.appendChild(d):a.appendChild(r.createTextNode(""+d));
return a},map:function(a,e,d,c,i){for(var b=[],f=0,l=d.length,j,t;f<l;f++){j=u({},e);if(c!==null){if(t=i?n.withMode(i,c,d[f],j,f):c(d[f],j,f),t===null)continue}else t=d[f];k(t)||(t=[t]);b.push(this.createElement(a,j,t,i))}return b},fragment:function(){var a=function(){var a;a=arguments.length===1&&k(arguments[0])?arguments[0]:q.call(arguments);y(a);if(this.mode!="dom")return this.modes[this.mode].fragment(a);for(var d=r.createDocumentFragment(),c=0,i=a.length,b;c<i;c++)b=a[c],b.nodeType?d.appendChild(b):
d.appendChild(r.createTextNode(""+b));return d};a.map=function(a,d){if(!l(d))return n.fragment(a);for(var c=[],i=0,b=a.length,f;i<b;i++)f=d(a[i],i),f!==null&&(c=c.concat(f));return n.fragment(c)};return a}(),util:{TAG_NAMES:d,EVENT_ATTRS:z,createElement:A,addEvent:a,setInnerHTML:i,extend:u,lookup:w,inheritFrom:function(a,d){function i(){}i.prototype=d.prototype;a.prototype=new i;a.prototype.constructor=a},isArray:k,isFunction:l,isObject:o,flatten:y}};v?u(module.exports,n):b.DOMBuilder=n})(this);
(function(b){function s(a){this.value=a}function u(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;").split("'").join("&#39;")}function w(a){if(a instanceof s)return a.value;return u(""+a)}function k(a){this.childNodes=a||[];this._inlineFragments()}function l(a,i,d){k.call(this,d);this.tagName=this.nodeName=a.toLowerCase();this.attributes=i||{};this.xhtml=j.mode=="XHTML"}function o(a){k.call(this,a)}var y=typeof module!=="undefined"&&module.exports,
j=y?require("./DOMBuilder"):b.DOMBuilder,p=Object.prototype.hasOwnProperty,v=Array.prototype.splice,r=j.util.addEvent,x=j.util.extend,b=j.util.inheritFrom,f=j.util.lookup,q=j.util.setInnerHTML,C=j.util.EVENT_ATTRS,z=f(j.util.TAG_NAMES),A=f("area base br col frame hr input img link meta param".split(" "));b(s,String);s.prototype.toString=s.prototype.valueOf=function(){return this.value};b(k,Object);k.prototype._inlineFragments=function(){for(var a=0,i=this.childNodes.length,d;a<i;a++)if(d=this.childNodes[a],
d instanceof o)v.apply(this.childNodes,[a,1].concat(d.childNodes)),d.childNodes=[]};k.prototype.appendChild=function(a){a instanceof o?(this.childNodes=this.childNodes.concat(a.childNodes),a.childNodes=[]):this.childNodes.push(a)};k.prototype.cloneNode=function(a){var i=this._clone();if(a===!0)for(var d=0,b=this.childNodes.length,f;d<b;d++)f=this.childNodes[d],f instanceof l?i.childNodes.push(f.cloneNode(a)):i.childNodes.push(f);return i};k.prototype._clone=function(){return new Node};b(l,k);l.eventTrackerId=
1;l.prototype.nodeType=1;l.prototype._clone=function(){var a=new l(this.tagName,x({},this.attributes));a.xhtml=this.xhtml;return a};l.prototype.toString=function(a){var a=a||!1,i=z[this.tagName]?this.tagName:w(this.tagName),d=["<"+i],b;for(b in this.attributes)if(b!=="innerHTML")if(C[b]){if(a===!0&&!this.eventsFound)this.eventsFound=!0}else d.push(" "+w(b.toLowerCase())+'="'+w(this.attributes[b])+'"');if(this.eventsFound&&!p.call(this.attributes,"id"))this.id="__DB"+l.eventTrackerId++ +"__",d.push(' id="'+
this.id+'"');d.push(">");if(A[i])return this.xhtml&&d.splice(d.length-1,1," />"),d.join("");if(p.call(this.attributes,"innerHTML"))d.push(this.attributes.innerHTML);else{b=0;for(var f=this.childNodes.length,j;b<f;b++)j=this.childNodes[b],j instanceof l||j instanceof s?d.push(j.toString(a)):d.push(u(""+j))}d.push("</"+i+">");return d.join("")};l.prototype.addEvents=function(){if(this.eventsFound){var a=p.call(this.attributes,"id")?w(this.attributes.id):this.id,b;for(b in this.attributes)C[b]&&r(a,
b,this.attributes[b]);delete this.eventsFound;delete this.id}a=0;b=this.childNodes.length;for(var d;a<b;a++)d=this.childNodes[a],d instanceof l&&d.addEvents()};l.prototype.insertWithEvents=function(a){q(a,this.toString(!0));this.addEvents()};b(o,k);o.prototype._clone=function(){return new o};o.prototype.nodeType=11;o.prototype.nodeName="#document-fragment";o.prototype.toString=function(a){for(var a=a||!1,b=[],d=0,f=this.childNodes.length,j;d<f;d++)j=this.childNodes[d],j instanceof l||j instanceof
s?b.push(j.toString(a)):b.push(u(""+j));return b.join("")};o.prototype.addEvents=function(){for(var a=0,b=this.childNodes.length,d;a<b;a++)d=this.childNodes[a],d instanceof l&&d.addEvents()};o.prototype.insertWithEvents=function(a){q(a,this.toString(!0));this.addEvents()};b={name:"html",createElement:function(a,b,d){return new l(a,b,d)},fragment:function(a){return new o(a)},isObject:function(a){return!(a instanceof k)&&!(a instanceof s)},api:{conditionalEscape:w,isSafe:function(a){return a instanceof
s},markSafe:function(a){return new s(a)},SafeString:s,HTMLNode:k,HTMLElement:l,HTMLFragment:o}};y?x(module.exports,b):j.addMode(b)})(this);
(function(b){function s(h){return g.call(h)==="[object String]"}function u(h){return h.replace("\\","\\\\").replace('"','\\"')}function w(h,a){for(var B=[],c=0,d=h.length,b;c<d;c++)b=h[c],b instanceof a&&B.push(b),b instanceof f&&typeof b.contents!="undefined"&&B.push.apply(B,w(b.contents,a));return B}function k(){this.message="pop() was called more times than push()"}function l(h){this.message=h}function o(h){this.message=h}function y(h){this.message=h}function j(h){this.expr=h}function p(h){if(!(this instanceof
p))return new p(h);this.stack=[h||{}];this.renderContext=new v}function v(h){this.stack=[h||{}]}function r(){this.blocks={}}function x(h,a){this.name=h.name;this.parent=h.extend||null;this.contents=a;for(var B=w(a,q),c={},b,d=0;b=B[d];d++){if(typeof c[b.name]!="undefined")throw new o("Block with name '"+b.name+"' appears more than once.");c[b.name]=b}this.blocks=c;f.prototype.parseContents.call(this);E[this.name]=this}function f(h){this.contents=h||[];this.contents.length&&this.parseContents()}function q(h,
a){this.name=s(h)?h:h.name;f.call(this,a)}function C(h,a){this.template=h;this.extraContext=a||{}}function z(h,a,B){this.tagName=h;this.attributes=a;f.call(this,B)}function A(h,b){for(var B in h){this.loopVars=B.split(L);this.listVar=new j(h[B]);break}this.emptyContents=b.length&&b[b.length-1]instanceof a?b.pop().contents:[];f.call(this,b)}function a(h){f.call(this,h)}function i(h,a){this.test=G(h)?h:this._parseExpr(h);this.elseContents=a.length&&a[a.length-1]instanceof d?a.pop().contents:[];f.call(this,
a)}function d(h){f.call(this,h)}function t(h){(this.dynamic=H.test(h))?this.func=this._parseExpr(h):this.text=h}function D(h,a){this.values=h;a=c({as:null,silent:!1},a||{});this.variableName=a.as;this.silent=a.silent;this.id="cycle"+D.cycleId++}var F=typeof module!=="undefined"&&module.exports,n=F?require("./DOMBuilder"):b.DOMBuilder,m=Object.prototype.hasOwnProperty,e=Array.prototype.slice,g=Object.prototype.toString,c=n.util.extend,b=n.util.inheritFrom,G=n.util.isFunction,I=n.util.lookup,L=/, ?/,
H=/{{(.*?)}}/,J=/^\s+|\s+$/g,E={},K=function(){var h={};return function(a,b){b.global||(m.call(h,b.source)||(h[b.source]=RegExp(b.source,"g")),b=h[b.source]);for(var c=[],d,e,f=0;d=b.exec(a);)e=d.index+d[0].length,e>f&&(c.push(a.slice(f,d.index)),d.length>1&&d.index<a.length&&c.push.apply(c,d.slice(1)),f=e),b.lastIndex===d.index&&b.lastIndex++;c.push(a.slice(f));return c}}();b(k,Error);b(l,Error);b(o,Error);b(y,Error);j.prototype.resolve=j.prototype.render=function(a){var b=this.expr.split("."),c=
b.shift(),d=a.get(c);if(a.hasKey(c))G(d)&&(d=d());else throw new l("Could not find ["+c+"] in "+a);if(b.length)for(var a=b.length,e=0;e<a;e++){c=b[e];if(d===null||d===void 0||typeof d[c]=="undefined")throw new l("Could not find ["+c+"] in "+d);c=d[c];d=G(c)?c.call(d):c}return d};p.prototype.push=function(a){this.stack.push(a||{})};p.prototype.pop=function(){if(this.stack.length==1)throw new k;return this.stack.pop()};p.prototype.set=function(a,b){this.stack[this.stack.length-1][a]=b};p.prototype.zip=
function(a,b){for(var c=this.stack[this.stack.length-1],d=Math.min(a.length,b.length),e=0;e<d;e++)c[a[e]]=b[e]};p.prototype.get=function(a,b){for(var c=this.stack.length-1;c>=0;c--)if(m.call(this.stack[c],a))return this.stack[c][a];return b!==void 0?b:null};p.prototype.hasKey=function(a){for(var b=0,c=this.stack.length;b<c;b++)if(m.call(this.stack[b],a))return!0;return!1};p.prototype.render=function(a){for(var b=[],c=0,d=a.length;c<d;c++)s(a[c])?b.push(a[c]):b.push(a[c].render(this));return b};b(v,
p);v.prototype.get=function(a,b){var c=this.stack[this.stack.length-1];if(m.call(c,a))return c[a];return b!==void 0?b:null};v.prototype.hasKey=function(a){return m.call(this.stack[this.stack.length-1],a)};r.prototype.addBlocks=function(a){for(var b in a)typeof this.blocks[b]!="undefined"?this.blocks[b].unshift(a[b]):this.blocks[b]=[a[b]]};r.prototype.push=function(a,b){this.blocks[a].push(b)};r.prototype.pop=function(a){if(typeof this.blocks[a]!="undefined"&&this.blocks[a].length)return this.blocks[a].pop();
return null};r.prototype.getBlock=function(a){if(typeof this.blocks[a]!="undefined"&&(a=this.blocks[a],a.length))return a[a.length-1];return null};x.prototype.render=function(a){a.renderContext.push();try{return this._render(a)}finally{a.renderContext.pop()}};x.prototype._render=function(a){a.renderContext.hasKey("blockContext")||a.renderContext.set("blockContext",new r);a.renderContext.get("blockContext").addBlocks(this.blocks);if(this.parent){if(typeof E[this.parent]=="undefined")throw new y("Could not find template named '"+
this.parent+'"');return E[this.parent]._render(a)}else return n.fragment(a.render(this.contents))};f.prototype.parseContents=function(){for(var a=0,b=this.contents.length,c;a<b;a++)c=this.contents[a],s(c)&&H.test(c)&&(this.contents[a]=new t(c))};b(q,f);q.prototype.render=function(a){var b=a.renderContext.get("blockContext"),c,d;a.push();b===null?(a.set("block",this),c=a.render(this.contents)):(d=c=b.pop(this.name),c===null&&(c=this),c=new q(c.name,c.contents),c.context=a,a.set("block",c),c=a.render(c.contents),
d!==null&&b.push(this.name,d));a.pop();return c};q.prototype["super"]=function(){var a=this.context.renderContext;if(a.hasKey("blockContext")&&a.get("blockContext").getBlock(this.name)!==null)return this.render(this.context);return""};b(C,f);C.prototype.render=function(a){if(typeof E[this.template]=="undefined")throw new y("Could not find template named '"+this.template+'"');a.push(this.extraContext);var b=E[this.template].render(a);a.pop();return b};b(z,f);z.prototype.render=function(a){return n.createElement(this.tagName,
this.attributes,a.render(this.contents))};b(A,f);A.prototype.render=function(a){var b=this.listVar.resolve(a),c=[],d={parentloop:a.get("forloop",{})},e=b.length,f;if(b.length<1)return a.render(this.emptyContents);a.push();a.set("forloop",d);for(var g=0;g<e;g++)f=b[g],this.loopVars.length===1?a.set(this.loopVars[0],f):a.zip(this.loopVars,f),d.counter=g+1,d.counter0=g,d.revcounter=e-g,d.revcounter0=e-g-1,d.first=g===0,d.last=g===e-1,c.push.apply(c,a.render(this.contents));a.pop();return c};b(a,f);a.prototype.render=
function(){return[]};b(i,f);i.prototype._parseExpr=function(){var a=I("( ) && || == === <= < >= > != !== !! !".split(" ")),b=/(\(|\)|&&|\|\||={2,3}|<=|<|>=|>|!={1,2}|!{1,2})/,c=/^-?(?:\d+(?:\.\d+)?|(?:\d+)?\.\d+)$/,d=I(['"',"'"]),e=function(a){var b=a.charAt(0);return a.length>1&&typeof d[b]!="undefined"&&a.lastIndexOf(b)==a.length-1};return function(d){for(var f=["return ("],g=K(d,b),i=0,l=g.length,k;i<l;i++)k=g[i],typeof a[k]!="undefined"?f.push(k):(k=k.replace(J,""))&&(c.test(k)||e(k)?f.push(k):
f.push('new Variable("'+u(k)+'").resolve(c)'));f.push(");");try{var m=new Function("c","Variable",f.join(" "));return function(a){return m(a,j)}}catch(n){throw new o("Invalid $if expression ("+n.message+"): "+d);}}}();i.prototype.render=function(a){return this.test(a)?a.render(this.contents):a.render(this.elseContents)};b(d,f);d.prototype.render=function(){return[]};b(t,f);t.prototype._parseExpr=function(a){for(var b=["var a = []"],a=K(a,H),c=0,d=a.length,e;c<d;c++)e=a[c],c%2?b.push('a.push(new Variable("'+
u(e.replace(J,""))+'").resolve(c))'):e&&b.push('a.push("'+u(e)+'")');b.push("return a");var f=new Function("c","Variable",b.join(";"));return function(a){return f(a,j)}};t.prototype.render=function(a){return this.dynamic?this.func(a):this.text};b(D,f);D.cycleId=1;D.prototype.render=function(a){var b=a.renderContext.get(this.id,0),c=this.values[b];a.renderContext.set(this.id,(b+1)%this.values.length);c instanceof j&&(c=c.resolve(a));this.variableName&&a.set(this.variableName,c);if(this.silent)return[];
return c};b={name:"template",createElement:function(a,b,c){return new z(a,b,c)},fragment:function(a){return a},isObject:function(a){return!(a instanceof f)},api:{ContextPopError:k,VariableNotFoundError:l,TemplateSyntaxError:o,TemplateNotFoundError:y,Variable:j,Context:p,RenderContext:v,BlockContext:r,Template:x,TemplateNode:f,BlockNode:q,IncludeNode:C,ElementNode:z,ForNode:A,IfNode:i,TextNode:t,CycleNode:D,$template:function(a){return new x(a,e.call(arguments,1))},$block:function(a){return new q(a,
e.call(arguments,1))},$include:function(a,b){return new C(a,b)},$var:function(a){return new j(a)},$text:function(a){return new t(a)},$for:function(a){return new A(a,e.call(arguments,1))},$empty:function(){return new a(e.call(arguments))},$if:function(a){return new i(a,e.call(arguments,1))},$else:function(){return new d(e.call(arguments))},$cycle:function(a,b){return new D(a,b)}}};F?c(module.exports,b):n.addMode(b)})(this);
